{% extends "layout.html" %}
{% block content %}
<h1 class="h5 mb-3 text-white">Alerts</h1>

<form class="row gy-2 gx-2 align-items-end mb-3" method="get">
  <div class="col-md-4">
    <label class="form-label text-white-50">Search (type/src/details)</label>
    <input name="q" class="form-control" value="{{ q or '' }}" placeholder="e.g., BEACONING or 192.168.1.50">
  </div>
  <div class="col-md-3">
    <label class="form-label text-white-50">Start (UTC date)</label>
    <input name="start" type="date" class="form-control" value="{{ start_val }}">
  </div>
  <div class="col-md-3">
    <label class="form-label text-white-50">End (UTC date)</label>
    <input name="end" type="date" class="form-control" value="{{ end_val }}">
  </div>
  <div class="col-md-2">
    <label class="form-label d-block text-white-50">&nbsp;</label>
    <button class="btn btn-primary w-100" type="submit">Apply</button>
  </div>
</form>

<div class="card shadow-sm">
<div class="table-responsive">
<table class="table table-sm table-striped mb-0">
  <thead><tr><th>Time (UTC)</th><th>Source</th><th>Type</th><th>Details</th></tr></thead>
  <tbody>
    {% for r in rows %}
    <tr>
      <td>{{ r.ts_iso }}</td><td>{{ r.src_ip }}</td><td><span class="badge bg-danger">{{ r.alert_type }}</span></td><td>{{ r.details }}</td>
    </tr>
    {% endfor %}
  </tbody>
</table>
</div>
</div>

<p class="mt-2 text-white-50">Showing {{ rows|length }} of {{ count }} â€” page {{ page }}</p>
<a class="btn btn-outline-light btn-sm" href="?page={{ page-1 if page>1 else 1 }}&size={{ size }}&q={{ q }}&start={{ start_val }}&end={{ end_val }}">Prev</a>
<a class="btn btn-outline-light btn-sm" href="?page={{ page+1 }}&size={{ size }}&q={{ q }}&start={{ start_val }}&end={{ end_val }}">Next</a>
{% endblock %}

